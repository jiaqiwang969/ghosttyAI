# QA-002 ä»»åŠ¡æ¸…å• - æµ‹è¯•å·¥ç¨‹å¸ˆ
## ç¬¬ä¸€å‘¨ï¼šç½‘æ ¼æ“ä½œæµ‹è¯•

### ä»»åŠ¡æ¦‚è§ˆ
**è§’è‰²**ï¼šTest Engineer (Grid Operations)  
**ä»»åŠ¡ID**ï¼šT-105  
**é¢„è®¡å·¥æœŸ**ï¼š2å¤©  
**å¼€å§‹æ—¶é—´**ï¼š2025-01-09 (å‘¨å››)  
**å®Œæˆæ—¶é—´**ï¼š2025-01-10 (å‘¨äº”)  

### ä¸»è¦ä»»åŠ¡ï¼šç½‘æ ¼æ“ä½œå•å…ƒæµ‹è¯•å¼€å‘

#### è¾“å…¥ (Inputs)
1. **å¼€å‘äº¤ä»˜ç‰©**
   - CORE-002 çš„ `backend_router.c` (å‘¨å››è·å¾—)
   - INTG-001 çš„ `backend_ghostty.c` (å‘¨å››è·å¾—)
   - CORE-001 çš„ hooks å®ç°

2. **æµ‹è¯•è§„èŒƒ** (æ¥è‡ª QA-001)
   - æµ‹è¯•æ¡†æ¶ç»“æ„
   - æµ‹è¯•ç”¨ä¾‹æ¨¡æ¿
   - è¦†ç›–ç‡è¦æ±‚

3. **æºä»£ç å‚è€ƒ**
   - `/Users/jqwang/98-ghosttyAI/tmux/grid.c`
   - `/Users/jqwang/98-ghosttyAI/tmux/grid-view.c`

#### è¾“å‡º (Outputs)
1. **test_grid_ops.c** - ç½‘æ ¼æ“ä½œæµ‹è¯•å¥—ä»¶
   ```c
   // æµ‹è¯•ç”¨ä¾‹ç»“æ„
   void test_grid_basic_write(void);
   void test_grid_unicode_emoji(void);
   void test_grid_wide_chars(void);
   void test_grid_scrolling(void);
   void test_grid_attributes(void);
   void test_grid_performance(void);
   ```

2. **test_fixtures/** - æµ‹è¯•æ•°æ®
   ```
   test_fixtures/
   â”œâ”€â”€ unicode_samples.txt    # Unicode æµ‹è¯•æ•°æ®
   â”œâ”€â”€ emoji_test.txt        # Emoji æµ‹è¯•
   â”œâ”€â”€ cjk_wide.txt         # ä¸­æ—¥éŸ©å®½å­—ç¬¦
   â””â”€â”€ ansi_sequences.txt   # ANSI è½¬ä¹‰åºåˆ—
   ```

3. **coverage_report.html** - è¦†ç›–ç‡æŠ¥å‘Š
   - ç›®æ ‡ï¼š>95% ç½‘æ ¼æ“ä½œè¦†ç›–
   - åˆ†æ”¯è¦†ç›–ç‡ >80%

4. **performance_baseline.json** - æ€§èƒ½åŸºå‡†
   ```json
   {
     "grid_write": {"avg_ns": 150, "max_ns": 500},
     "grid_scroll": {"avg_ns": 1000, "max_ns": 5000},
     "span_merge": {"reduction": "65%"}
   }
   ```

#### å…·ä½“æ­¥éª¤ (Steps)

**å‘¨å››ï¼šæµ‹è¯•å¼€å‘**
1. **9:00-10:00** - è·å–å¹¶ç†è§£å¼€å‘äº¤ä»˜ç‰©
2. **10:00-12:00** - ç¼–å†™åŸºç¡€æµ‹è¯•
   ```c
   void test_grid_basic_write(void) {
       struct grid *g = grid_create(80, 24);
       struct grid_cell cell = {.data = 'A', .attr = 0};
       
       grid_set_cell(g, 0, 0, &cell);
       assert(grid_get_cell(g, 0, 0)->data == 'A');
       
       grid_destroy(g);
   }
   ```
3. **13:00-15:00** - ç¼–å†™ Unicode/Emoji æµ‹è¯•
   ```c
   void test_grid_unicode_emoji(void) {
       // æµ‹è¯• emoji ğŸ‰
       // æµ‹è¯•ç»„åˆå­—ç¬¦ Ã© (e + Ì)
       // æµ‹è¯• Zero Width Joiner
   }
   ```
4. **15:00-17:00** - ç¼–å†™å®½å­—ç¬¦æµ‹è¯•
5. **17:00-18:00** - åˆæ­¥æµ‹è¯•è¿è¡Œ

**å‘¨äº”ï¼šæµ‹è¯•æ‰§è¡Œå’Œä¼˜åŒ–**
1. **9:00-10:00** - æ€§èƒ½æµ‹è¯•å¼€å‘
2. **10:00-11:00** - è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
3. **11:00-12:00** - ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
4. **13:00-14:00** - ä¿®å¤å‘ç°çš„é—®é¢˜
5. **14:00-15:00** - æ€§èƒ½åŸºå‡†æµ‹è¯•
6. **15:00-16:00** - æœ€ç»ˆæµ‹è¯•è¿è¡Œ
7. **16:00-17:00** - æäº¤ç»™ QA-001
8. **17:00-18:00** - å‚ä¸é›†æˆæµ‹è¯•

#### æµ‹è¯•åœºæ™¯ (Test Scenarios)

**1. åŸºç¡€ç½‘æ ¼æ“ä½œ**
- å•å­—ç¬¦å†™å…¥/è¯»å–
- è¡Œ/åˆ—æ“ä½œ
- æ¸…å±æ“ä½œ
- æ»šåŠ¨ï¼ˆä¸Š/ä¸‹ï¼‰

**2. Unicode å¤„ç†**
- ASCII (1 byte)
- Latin-1 (2 bytes)
- CJK (3 bytes)
- Emoji (4 bytes)
- ç»„åˆå­—ç¬¦
- Zero-width å­—ç¬¦

**3. å®½å­—ç¬¦å¤„ç†**
```c
// ä¸­æ–‡å®½å­—ç¬¦æµ‹è¯•
void test_cjk_wide_chars(void) {
    const char *text = "ä½ å¥½ä¸–ç•Œ";
    // æ¯ä¸ªä¸­æ–‡å­—ç¬¦å  2 åˆ—
    assert(string_width(text) == 8);
}
```

**4. å±æ€§æµ‹è¯•**
- å‰æ™¯è‰²/èƒŒæ™¯è‰²
- ç²—ä½“/æ–œä½“/ä¸‹åˆ’çº¿
- åè½¬/é—ªçƒ
- 256è‰²/çœŸå½©è‰²

**5. è¾¹ç•Œæ¡ä»¶**
- ç©ºç½‘æ ¼
- æ»¡ç½‘æ ¼
- è¶…é•¿è¡Œ
- å¤§é‡æ»šåŠ¨

**6. æ€§èƒ½æµ‹è¯•**
```c
void test_performance_bulk_write(void) {
    struct timespec start, end;
    clock_gettime(CLOCK_MONOTONIC, &start);
    
    // å†™å…¥ 1MB æ–‡æœ¬
    for (int i = 0; i < 1000000; i++) {
        grid_write_char(grid, 'A' + (i % 26));
    }
    
    clock_gettime(CLOCK_MONOTONIC, &end);
    uint64_t elapsed_ns = timespec_diff_ns(&end, &start);
    
    // åº”è¯¥åœ¨ 100ms å†…å®Œæˆ
    assert(elapsed_ns < 100000000);
}
```

#### éªŒæ”¶æ ‡å‡† (Acceptance Criteria)
- [ ] æ‰€æœ‰åŸºç¡€æ“ä½œæµ‹è¯•é€šè¿‡
- [ ] Unicode/Emoji æ­£ç¡®å¤„ç†
- [ ] å®½å­—ç¬¦æ˜¾ç¤ºæ­£ç¡®
- [ ] æ€§èƒ½è¾¾åˆ°åŸºå‡†è¦æ±‚
- [ ] ä»£ç è¦†ç›–ç‡ >95%
- [ ] æ— å†…å­˜æ³„æ¼ï¼ˆvalgrind æ£€æŸ¥ï¼‰

#### æµ‹è¯•å·¥å…· (Test Tools)
```bash
# è¿è¡Œæµ‹è¯•
make test-grid

# è¦†ç›–ç‡
make coverage

# å†…å­˜æ£€æŸ¥
valgrind --leak-check=full ./test_grid_ops

# æ€§èƒ½åˆ†æ
perf record ./test_grid_ops
perf report
```

#### åä½œè¦æ±‚ (Collaboration)
- **ä¾èµ– CORE-002**ï¼šéœ€è¦ backend router
- **ä¾èµ– INTG-001**ï¼šéœ€è¦ Ghostty backend
- **æ±‡æŠ¥ç»™ QA-001**ï¼šæµ‹è¯•ç»“æœå’Œè¦†ç›–ç‡

#### Bug æŠ¥å‘Šæ¨¡æ¿ (Bug Report Template)
```markdown
**Bug ID**: BUG-001
**ä¸¥é‡æ€§**: P0/P1/P2
**ç»„ä»¶**: Grid Operations
**æè¿°**: [é—®é¢˜æè¿°]
**é‡ç°æ­¥éª¤**:
1. [æ­¥éª¤1]
2. [æ­¥éª¤2]
**æœŸæœ›ç»“æœ**: [æœŸæœ›]
**å®é™…ç»“æœ**: [å®é™…]
**å½±å“**: [å½±å“èŒƒå›´]
```

#### æ¯æ—¥æ±‡æŠ¥ (Daily Report)
```
STATUS [QA-002] [æ—¥æœŸ]
ä»»åŠ¡ï¼šT-105 ç½‘æ ¼æ“ä½œæµ‹è¯•
ç¼–å†™ç”¨ä¾‹ï¼š[æ•°é‡]
æ‰§è¡Œç”¨ä¾‹ï¼š[é€šè¿‡/å¤±è´¥]
è¦†ç›–ç‡ï¼š[ç™¾åˆ†æ¯”]
Bugå‘ç°ï¼š[æ•°é‡å’Œä¸¥é‡æ€§]
é˜»å¡ï¼š[å¦‚æœ‰]
```